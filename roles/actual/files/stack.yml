version: '3.7'
networks:
  jenkins:
    driver: overlay
services:
  manager:
    command: '-jar /usr/share/jenkins/jenkins.war'
    deploy:
      replicas: 1
      labels:
        com.docker.lb.hosts: manager.jenkins
        com.docker.lb.networks: jenkins
        com.docker.lb.port: 8080
      placement:
        constraints:
          - node.role==worker
    entrypoint: java
    image: jenkins/jenkins:alpine
    networks:
      - jenkins
    volumes:
      - '/var/run/docker.sock:/var/run/docker.sock'
      - '/srv/jenkins_home:/var/jenkins_home'
