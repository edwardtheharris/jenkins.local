---
- name: Pull Jenkins image.
  docker_image:
    name: jenkins/jenkins:alpine
    pull: yes
    state: present
  tags:
    - image
- name: Verify docker network.
  docker_network:
    name: money
    state: present
  tags:
    - network
- name: Start Jenkins
  docker_container:
    image: jenkins/jenkins:alpine
    name: jenkins
    networks:
      - name: money
    restart_policy: always
    state: started
    volumes:
      - /srv/jenkins:/var/jenkins_home
      - /var/run/docker.sock:/var/run/docker.sock
  tags:
    - container
- name: Deploy Jenkins Stack
  docker_stack:
    name: jenkins
    compose:
      - roles/actual/files/stack.yml
    state: present
  environment:
    DOCKER_CERT_PATH: '/Users/duchess/Downloads/ucp-bundle-xander'
    DOCKER_HOST: 'tcp://ucp.brick-house.org:443'
    DOCKER_TLS_VERIFY: 1
  tags:
    - stack
- name: Stop Jenkins
  docker_container:
    name: jenkins
    state: absent
  tags:
    - stop
